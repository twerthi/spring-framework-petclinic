pipeline {
    agent any
    tools {
        jfrog 'JFrog CLI'
    }
    stages {
            stage ('Set version') {
                steps {
                    script {
                        TEST_VAR = new Date().format("yyyy.MM.dd") as String
                        echo "${TEST_VAR}"
                        VERSION_NUMBER = VersionNumber(versionNumberString: "${TEST_VAR}.${BUILD_ID}")
                        currentBuild.displayName = "${VERSION_NUMBER}"
                    }
                }
            }
            stage ('Build') {
                steps {
                    bat "mvn clean package -DskipTests=true -Dproject.versionNumber=${VERSION_NUMBER} -DgroupId=com.octopus -DartifactId=PetClinic.Web"
                }
            }
            stage ('Push') {
                steps {
                    jf 'rt u target/*.war/ artifactory-maven/ '
 
                        }
            }
    }
}
